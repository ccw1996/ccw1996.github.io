"use strict";(self.webpackChunkblog_sample=self.webpackChunkblog_sample||[]).push([[4690],{841:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>r,default:()=>p,frontMatter:()=>a,metadata:()=>c,toc:()=>l});var i=t(5893),s=t(1151);const a={title:"FPS\u8ba1\u7b97\u65b9\u5f0f",description:"FPS\u8ba1\u7b97\u65b9\u5f0f",tags:["work"],editor:"caroot"},r=void 0,c={id:"cpp/work/fps_calc",title:"FPS\u8ba1\u7b97\u65b9\u5f0f",description:"FPS\u8ba1\u7b97\u65b9\u5f0f",source:"@site/docs/cpp/work/fps_calc.md",sourceDirName:"cpp/work",slug:"/cpp/work/fps_calc",permalink:"/docs/cpp/work/fps_calc",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/cpp/work/fps_calc.md",tags:[{label:"work",permalink:"/docs/tags/work"}],version:"current",lastUpdatedAt:1708438540,formattedLastUpdatedAt:"Feb 20, 2024",frontMatter:{title:"FPS\u8ba1\u7b97\u65b9\u5f0f",description:"FPS\u8ba1\u7b97\u65b9\u5f0f",tags:["work"],editor:"caroot"},sidebar:"tutorialSidebar",previous:{title:"\u5806\u6808\u4f7f\u7528\u7f16\u8bd1\u8b66\u544a\u548c\u9519\u8bef",permalink:"/docs/cpp/work/cpp_stack"},next:{title:"\u5341\u516d\u8fdb\u5236\u8f6cdouble",permalink:"/docs/cpp/work/hex2double"}},o={},l=[{value:"\u56fa\u5b9a\u65f6\u95f4\u5e27\u6570\u6cd5",id:"\u56fa\u5b9a\u65f6\u95f4\u5e27\u6570\u6cd5",level:2},{value:"\u56fa\u5b9a\u5e27\u6570\u65f6\u95f4\u6cd5",id:"\u56fa\u5b9a\u5e27\u6570\u65f6\u95f4\u6cd5",level:2},{value:"\u5b9e\u65f6\u8ba1\u7b97\u6cd5",id:"\u5b9e\u65f6\u8ba1\u7b97\u6cd5",level:2},{value:"\u603b\u5e73\u5747\u6cd5",id:"\u603b\u5e73\u5747\u6cd5",level:2},{value:"\u7cbe\u786e\u91c7\u6837\u6cd5",id:"\u7cbe\u786e\u91c7\u6837\u6cd5",level:2},{value:"\u5e73\u5747\u91c7\u6837\u6cd5",id:"\u5e73\u5747\u91c7\u6837\u6cd5",level:2}];function d(n){const e={code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"\u56fa\u5b9a\u65f6\u95f4\u5e27\u6570\u6cd5",children:"\u56fa\u5b9a\u65f6\u95f4\u5e27\u6570\u6cd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"fps = frameNum / elapsedTime;\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u56fa\u5b9a\u5e27\u6570\u65f6\u95f4\u6cd5",children:"\u56fa\u5b9a\u5e27\u6570\u65f6\u95f4\u6cd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"fps = frameNum / elapsedTime;\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5b9e\u65f6\u8ba1\u7b97\u6cd5",children:"\u5b9e\u65f6\u8ba1\u7b97\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u5b9e\u65f6\u8ba1\u7b97\u6cd5\u76f4\u63a5\u4f7f\u7528\u4e0a\u4e00\u5e27\u7684\u65f6\u95f4\u95f4\u9694\u8fdb\u884c\u8ba1\u7b97"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"int fps(int deltaTime) // ms\n{\n    int fps = static_cast<int>(1.f / deltaTime * 1000); // \u522b\u5fd8\u4e86\u5148\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570\uff0c\u5426\u5219\u4f1a\u6709\u7cbe\u5ea6\u4e22\u5931\n    return fps;\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u603b\u5e73\u5747\u6cd5",children:"\u603b\u5e73\u5747\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u603b\u5e73\u5747\u6cd5\u4f7f\u7528\u5168\u5c40\u5e27\u6570\u9664\u4ee5\u5168\u5c40\u65f6\u95f4\uff0c\u4ee5\u6c42\u51fa\u5e27\u7387\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"int beginTime = getTime();\n\nint fps()\n{\n    static int frameCount = 0;\n\n    ++frameCount;\n\n    int deltaTime = getTime() - beginTime();\n    return static_cast<int>(frameCount * 1.f / deltaTime * 1000); // \u522b\u5fd8\u4e86\u5148\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570\uff0c\u5426\u5219\u4f1a\u6709\u7cbe\u5ea6\u4e22\u5931\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u7cbe\u786e\u91c7\u6837\u6cd5",children:"\u7cbe\u786e\u91c7\u6837\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u7cbe\u786e\u91c7\u6837\u6cd5\u91c7\u6837\u524dN\u4e2a\u5e27\uff0c\u7136\u540e\u8ba1\u7b97\u5e73\u5747\u503c\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"int fps(int deltaTime) // ms\n{\n    static std::queue<int> q;\n    static int sumDuration = 0; // ms\n\n    int fps = 0;\n    if (q.size() < 100) // \u6837\u672c\u6570\u8bbe\u4e3a100\n    {\n        sumDuration += deltaTime;\n        q.push(deltaTime);\n        fps = static_cast<int>(q.size() * 1.f / sumDuration * 1000.f); // \u522b\u5fd8\u4e86\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570\uff0c\u5426\u5219\u4f1a\u6709\u7cbe\u5ea6\u4e22\u5931\n    }\n    else\n    {\n        sumDuration -= q.front();\n        sumDuration += deltaTime;\n        sumDuration.pop();\n        sumDuration.push(deltaTime);\n        fps = static_cast<int>(100.f / sumDuration * 1000.f); // \u522b\u5fd8\u4e86\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570\uff0c\u5426\u5219\u4f1a\u6709\u7cbe\u5ea6\u4e22\u5931\n    }\n    return fps;\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5e73\u5747\u91c7\u6837\u6cd5",children:"\u5e73\u5747\u91c7\u6837\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u5e73\u5747\u91c7\u6837\u6cd5\u5229\u7528\u4e0a\u6b21\u7684\u7edf\u8ba1\u7ed3\u679c\uff0c\u514b\u670d\u4e86\u7cbe\u786e\u91c7\u6837\u6cd5\u9700\u8981\u4f7f\u7528\u989d\u5916\u7a7a\u95f4\u7684\u7f3a\u70b9\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"int fps(int deltaTime) // ms\n{\n    static float avgDuration = 0.f;\n    static alpha = 1.f / 100.f; // \u91c7\u6837\u6570\u8bbe\u7f6e\u4e3a100\n    static int frameCount = 0;\n\n    ++frameCount;\n\n    int fps = 0;\n    if (1 == frameCount)\n    {\n        avgDuration = static_cast<float>(deltaTime);\n    }\n    else\n    {\n        avgDuration = avgDuration * (1 - alpha) + deltaTime * alpha; \n    }\n\n    fps = static_cast<int>(1.f / avgDuration * 1000);\n    return fps;\n}\n"})})]})}function p(n={}){const{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},1151:(n,e,t)=>{t.d(e,{Z:()=>c,a:()=>r});var i=t(7294);const s={},a=i.createContext(s);function r(n){const e=i.useContext(a);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),i.createElement(a.Provider,{value:e},n.children)}}}]);